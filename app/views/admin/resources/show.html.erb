<% content_for :sidebar do %>
  <%= build_sidebar %>
<% end %>

<% content_for :search do %>
  <%= search %>
<% end %>

<h2>
  <%= _("Show {{resource}}", :resource => @resource.human_name) %>
  <small><%= link_to_edit %></small>
</h2>

<%= typus_block %>

<dl>
<%- @fields.each do |field| -%>
  <dt><%=h @resource.human_attribute_name(field.first) %></dt>
  <%-
    data_type = field.last
    raw_data = @item.send(field.first)
    data = case data_type
           when :boolean
             boolean_hash = @resource.typus_boolean(field.first)
             !raw_data.nil? ? boolean_hash["#{raw_data}".to_sym] : @resource.typus_options_for(:nil)
           when :belongs_to
             if !raw_data.nil?
               controller = raw_data.class.to_resource
               action = raw_data.class.typus_options_for(:default_action_on_item)
               options = { :controller => controller, :action => action, :id => raw_data }
               link_to raw_data.to_label, options
             else
               nil
             end
           when :file
             typus_preview(@item, field.first)
           when :text
             defined?(RDiscount) ? markdown(raw_data) : simple_format(h(raw_data))
           when :selector
             @item.mapping(field.first)
           else
             h(raw_data)
           end
  -%>
  <dd><%= raw !data.blank? ? data : ("&#151;") %></dd>
<%- end -%>
</dl>

<%= raw typus_relationships %>
